<div class="checkout-container">
  <h1>Checkout</h1>
  
  <div class="checkout-content">
    <div class="checkout-form-section">
      <h2>Shipping Information</h2>
      
      <form [formGroup]="checkoutForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="fullName">Full Name *</label>
          <input 
            type="text" 
            id="fullName" 
            formControlName="fullName"
            class="form-control"
            [class.invalid]="fullName?.invalid && fullName?.touched">
          <div class="error-message" *ngIf="fullName?.invalid && fullName?.touched">
            <span *ngIf="fullName?.errors?.['required']">Full name is required</span>
            <span *ngIf="fullName?.errors?.['minlength']">Name must be at least 3 characters</span>
          </div>
        </div>

        <div class="form-group">
          <label for="address">Address *</label>
          <input 
            type="text" 
            id="address" 
            formControlName="address"
            class="form-control"
            [class.invalid]="address?.invalid && address?.touched">
          <div class="error-message" *ngIf="address?.invalid && address?.touched">
            <span *ngIf="address?.errors?.['required']">Address is required</span>
            <span *ngIf="address?.errors?.['minlength']">Address must be at least 6 characters</span>
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email *</label>
          <input 
            type="email" 
            id="email" 
            formControlName="email"
            class="form-control"
            [class.invalid]="email?.invalid && email?.touched">
          <div class="error-message" *ngIf="email?.invalid && email?.touched">
            <span *ngIf="email?.errors?.['required']">Email is required</span>
            <span *ngIf="email?.errors?.['email']">Please enter a valid email</span>
          </div>
        </div>

        <div class="form-group">
          <label for="creditCard">Credit Card Number (16 digits) *</label>
          <input 
            type="text" 
            id="creditCard" 
            formControlName="creditCard"
            class="form-control"
            maxlength="16"
            placeholder="1234567890123456"
            [class.invalid]="creditCard?.invalid && creditCard?.touched">
          <div class="error-message" *ngIf="creditCard?.invalid && creditCard?.touched">
            <span *ngIf="creditCard?.errors?.['required']">Credit card is required</span>
            <span *ngIf="creditCard?.errors?.['pattern']">Must be exactly 16 digits</span>
          </div>
        </div>

        <!-- Template-driven form field using ngModel and ngModelChange -->
        <div class="form-group">
          <label for="phoneNumber">Phone Number (Optional)</label>
          <input 
            type="text" 
            id="phoneNumber" 
            name="phoneNumber"
            [(ngModel)]="phoneNumber"
            (ngModelChange)="onPhoneNumberChange($event)"
            class="form-control"
            placeholder="1234567890"
            [class.invalid]="phoneError"
            [ngModelOptions]="{standalone: true}">
          <!-- Error message displayed using ngIf, updated by ngModelChange -->
          <div class="error-message" *ngIf="phoneError">
            <span>{{ phoneError }}</span>
          </div>
        </div>

        <button 
          type="submit" 
          class="submit-button"
          [disabled]="checkoutForm.invalid || phoneError">
          Complete Order
        </button>
      </form>
    </div>

    <div class="order-summary">
      <h2>Order Summary</h2>
      
      <div class="summary-items">
        <div *ngFor="let item of cartItems" class="summary-item">
          <span class="item-name">{{ item.product.name }} (x{{ item.quantity }})</span>
          <span class="item-price">${{ (item.product.price * item.quantity).toFixed(2) }}</span>
        </div>
      </div>
      
      <div class="summary-total">
        <span class="total-label">Total:</span>
        <span class="total-amount">${{ total.toFixed(2) }}</span>
      </div>
    </div>
  </div>
</div>
